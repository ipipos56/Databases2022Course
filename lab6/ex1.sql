CREATE TABLE IF NOT EXISTS Suppliers (
sid integer NOT NULL PRIMARY KEY,
sname text NOT NULL,
address text NOT NULL
);

INSERT INTO Suppliers(sid, sname, address)
VALUES (1, 'Yosemite Sham', 'Devil’s canyon, AZ');
INSERT INTO Suppliers(sid, sname, address)
VALUES (2, 'Wiley E. Coyote', 'RR Asylum, NV');
INSERT INTO Suppliers(sid, sname, address)
VALUES (3, 'Elmer Fudd', 'Carrot Patch, MN');

CREATE TABLE IF NOT EXISTS Parts (
pid integer NOT NULL PRIMARY KEY,
pname text NOT NULL,
color text NOT NULL
);

INSERT INTO Parts(pid, pname, color)
VALUES (1, 'Red1', 'Red');
INSERT INTO Parts(pid, pname, color)
VALUES (2, 'Red2', 'Red');
INSERT INTO Parts(pid, pname, color)
VALUES (3, 'Green1', 'Green');
INSERT INTO Parts(pid, pname, color)
VALUES (4, 'Blue1', 'Blue');
INSERT INTO Parts(pid, pname, color)
VALUES (5, 'Red3', 'Red');

CREATE TABLE IF NOT EXISTS Catalog (
id integer NOT NULL PRIMARY KEY generated by default as identity,
pid integer NOT NULL,
sid integer NOT NULL,
cost float NOT NULL,
FOREIGN KEY(pid) REFERENCES Parts(pid),
FOREIGN KEY(sid) REFERENCES Suppliers(sid)
);

INSERT INTO Catalog(sid, pid, cost)
VALUES (1, 1, 10.0);
INSERT INTO Catalog(sid, pid, cost)
VALUES (1, 2, 20.0);
INSERT INTO Catalog(sid, pid, cost)
VALUES (1, 3, 30.0);
INSERT INTO Catalog(sid, pid, cost)
VALUES (1, 4, 40.0);
INSERT INTO Catalog(sid, pid, cost)
VALUES (1, 5, 50.0);
INSERT INTO Catalog(sid, pid, cost)
VALUES (2, 1, 9.0);
INSERT INTO Catalog(sid, pid, cost)
VALUES (2, 3, 34.0);
INSERT INTO Catalog(sid, pid, cost)
VALUES (2, 5, 48.0);

-- • Find the names of suppliers who supply some red part.
SELECT distinct sname from Suppliers
    join Catalog C on Suppliers.sid = C.sid
    join Parts P on P.pid = C.pid
    where P.color = 'Red';

-- • Find the sids of suppliers who supply some red or green part.
SELECT distinct Suppliers.sid from Suppliers
    join Catalog C on Suppliers.sid = C.sid
    join Parts P on P.pid = C.pid
    where P.color = 'Red' or P.color = 'Green';

-- • Find the sids of suppliers who supply some red part or are at 221 Packer Street.
SELECT distinct S.sid from Suppliers S
    join Catalog C on S.sid = C.sid
    join Parts P on P.pid = C.pid
    where P.color = 'Red' or S.address = '221 Packer Street';

